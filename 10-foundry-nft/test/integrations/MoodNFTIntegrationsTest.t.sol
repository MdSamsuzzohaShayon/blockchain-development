// SPDX-License-Identifier: MIT
pragma solidity ^0.8.19;

import {Test, console} from "forge-std/Test.sol";
import {DeployMoodNFT} from "script/DeployMoodNFT.s.sol";
import {MoodNFT} from "src/MoodNFT.sol";

contract MoodNFTIntegrationsTest is Test {
    MoodNFT moodNft;
    string public constant HAPPY_SVG_IMAGE_URI =
        "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+CiAgPCEtLSBGYWNlIENpcmNsZSB3aXRoIEdyYWRpZW50IC0tPgogIDxkZWZzPgogICAgPHJhZGlhbEdyYWRpZW50IGlkPSJmYWNlR3JhZGllbnQiIGN4PSI1MCUiIGN5PSI1MCUiIHI9IjUwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNGRkVCM0I7IHN0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiNGQkMwMkQ7IHN0b3Atb3BhY2l0eToxIiAvPgogICAgPC9yYWRpYWxHcmFkaWVudD4KICA8L2RlZnM+CiAgPGNpcmNsZSBjeD0iMTAwIiBjeT0iMTAwIiByPSI5MCIgZmlsbD0idXJsKCNmYWNlR3JhZGllbnQpIiBzdHJva2U9IiNGNTdGMTciIHN0cm9rZS13aWR0aD0iNSIvPgoKICA8IS0tIExlZnQgRXllIHdpdGggR3JhZGllbnQgYW5kIFNoaW5lIC0tPgogIDxkZWZzPgogICAgPHJhZGlhbEdyYWRpZW50IGlkPSJleWVHcmFkaWVudCIgY3g9IjUwJSIgY3k9IjUwJSIgcj0iNTAlIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3R5bGU9InN0b3AtY29sb3I6IzU1NTsgc3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6IzIyMjsgc3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L3JhZGlhbEdyYWRpZW50PgogIDwvZGVmcz4KICA8Y2lyY2xlIGN4PSI2NSIgY3k9IjgwIiByPSIxMiIgZmlsbD0idXJsKCNleWVHcmFkaWVudCkiLz4KICA8Y2lyY2xlIGN4PSI2MCIgY3k9Ijc1IiByPSIzIiBmaWxsPSJ3aGl0ZSIgLz4KCiAgPCEtLSBSaWdodCBFeWUgd2l0aCBHcmFkaWVudCBhbmQgU2hpbmUgLS0+CiAgPGNpcmNsZSBjeD0iMTM1IiBjeT0iODAiIHI9IjEyIiBmaWxsPSJ1cmwoI2V5ZUdyYWRpZW50KSIvPgogIDxjaXJjbGUgY3g9IjEzMCIgY3k9Ijc1IiByPSIzIiBmaWxsPSJ3aGl0ZSIgLz4KCiAgPCEtLSBNb3V0aCAoSGFwcHkpIHdpdGggRGVwdGggLS0+CiAgPHBhdGggZD0iTSA1MCAxMzAgUSAxMDAgMTcwIDE1MCAxMzAiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSI2IiBmaWxsPSJ0cmFuc3BhcmVudCIgLz4KICA8cGF0aCBkPSJNIDUwIDEzMCBRIDEwMCAxNjAgMTUwIDEzMCIgc3Ryb2tlPSIjNTU1IiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9InRyYW5zcGFyZW50IiAvPgoKICA8IS0tIEJsdXNoIENpcmNsZXMgZm9yIEV4dHJhIERldGFpbCAtLT4KICA8Y2lyY2xlIGN4PSI1MCIgY3k9IjExMCIgcj0iMTIiIGZpbGw9InJnYmEoMjU1LDEwNSwxODAsMC40KSIgLz4KICA8Y2lyY2xlIGN4PSIxNTAiIGN5PSIxMTAiIHI9IjEyIiBmaWxsPSJyZ2JhKDI1NSwxMDUsMTgwLDAuNCkiIC8+CgogIDwhLS0gRXllYnJvd3MgLS0+CiAgPHBhdGggZD0iTSA1NSA2MCBRIDY1IDUwIDc1IDYwIiBzdHJva2U9IiMzMzMiIHN0cm9rZS13aWR0aD0iNCIgZmlsbD0idHJhbnNwYXJlbnQiIC8+CiAgPHBhdGggZD0iTSAxMjUgNjAgUSAxMzUgNTAgMTQ1IDYwIiBzdHJva2U9IiMzMzMiIHN0cm9rZS13aWR0aD0iNCIgZmlsbD0idHJhbnNwYXJlbnQiIC8+Cjwvc3ZnPgo=";
    string public constant SAD_SVG_IMAGE_URI =
        "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgNDAwIiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCI+CiAgPCEtLSBGYWNlIENpcmNsZSAtLT4KICA8Y2lyY2xlIGN4PSIyMDAiIGN5PSIyMDAiIHI9IjE4MCIgZmlsbD0iI0ZGRUIzQiIgc3Ryb2tlPSIjRkJDMDJEIiBzdHJva2Utd2lkdGg9IjEwIi8+CgogIDwhLS0gTGVmdCBFeWUgLS0+CiAgPGVsbGlwc2UgY3g9IjE0MCIgY3k9IjE2MCIgcng9IjMwIiByeT0iMjAiIGZpbGw9IndoaXRlIiBzdHJva2U9IiMzMzMiIHN0cm9rZS13aWR0aD0iMyIvPgogIDxjaXJjbGUgY3g9IjE0MCIgY3k9IjE2MCIgcj0iMTAiIGZpbGw9IiMzMzMiLz4KCiAgPCEtLSBSaWdodCBFeWUgLS0+CiAgPGVsbGlwc2UgY3g9IjI2MCIgY3k9IjE2MCIgcng9IjMwIiByeT0iMjAiIGZpbGw9IndoaXRlIiBzdHJva2U9IiMzMzMiIHN0cm9rZS13aWR0aD0iMyIvPgogIDxjaXJjbGUgY3g9IjI2MCIgY3k9IjE2MCIgcj0iMTAiIGZpbGw9IiMzMzMiLz4KCiAgPCEtLSBEcm9vcGluZyBFeWVicm93cyAtLT4KICA8cGF0aCBkPSJNIDEwMCAxMzAgUSAxNDAgMTEwIDE4MCAxMzAiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSI1IiBmaWxsPSJ0cmFuc3BhcmVudCIvPgogIDxwYXRoIGQ9Ik0gMjIwIDEzMCBRIDI2MCAxMTAgMzAwIDEzMCIgc3Ryb2tlPSIjMzMzIiBzdHJva2Utd2lkdGg9IjUiIGZpbGw9InRyYW5zcGFyZW50Ii8+CgogIDwhLS0gU2FkIE1vdXRoIC0tPgogIDxwYXRoIGQ9Ik0gMTMwIDI4MCBRIDIwMCAyMjAgMjcwIDI4MCIgc3Ryb2tlPSIjMzMzIiBzdHJva2Utd2lkdGg9IjgiIGZpbGw9InRyYW5zcGFyZW50IiAvPgoKICA8IS0tIFRlYXJzIC0tPgogIDxwYXRoIGQ9Ik0gMTMwIDE4MCBDIDEyNSAyMjAgMTQ1IDI0MCAxNTAgMjIwIiBmaWxsPSJibHVlIiBmaWxsLW9wYWNpdHk9IjAuNiIvPgogIDxwYXRoIGQ9Ik0gMjcwIDE4MCBDIDI2NSAyMjAgMjg1IDI0MCAyOTAgMjIwIiBmaWxsPSJibHVlIiBmaWxsLW9wYWNpdHk9IjAuNiIvPgoKICA8IS0tIENoZWVrIFNoYWRpbmcgZm9yIERlcHRoIC0tPgogIDxkZWZzPgogICAgPHJhZGlhbEdyYWRpZW50IGlkPSJjaGVla0dyYWRpZW50IiBjeD0iNTAlIiBjeT0iNTAlIiByPSI1MCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjpyZ2JhKDI1NSwxNTMsMTAyLDAuNCk7c3RvcC1vcGFjaXR5OjAuNCIgLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjpyZ2JhKDI1NSwxNTMsMTAyLDApO3N0b3Atb3BhY2l0eTowIiAvPgogICAgPC9yYWRpYWxHcmFkaWVudD4KICA8L2RlZnM+CiAgPGVsbGlwc2UgY3g9IjE0MCIgY3k9IjI1MCIgcng9IjUwIiByeT0iMzAiIGZpbGw9InVybCgjY2hlZWtHcmFkaWVudCkiIC8+CiAgPGVsbGlwc2UgY3g9IjI2MCIgY3k9IjI1MCIgcng9IjUwIiByeT0iMzAiIGZpbGw9InVybCgjY2hlZWtHcmFkaWVudCkiIC8+Cjwvc3ZnPgo=";

    string public constant SAD_SVG_URI =
        "data:application/json;base64,eyJuYW1lIjoiTW9vZCBORlQiLCAiZGVzY3JpcHRpb24iOiJBbiBORlQgdGhhdCByZWZsZWN0cyB0aGUgbW9vZCBvZiB0aGUgb3duZXIsIDEwMCUgb24gQ2hhaW4hIiwgImF0dHJpYnV0ZXMiOiBbeyJ0cmFpdF90eXBlIjogIm1vb2RpbmVzcyIsICJ2YWx1ZSI6IDEwMH1dLCAiaW1hZ2UiOiJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSFpwWlhkQ2IzZzlJakFnTUNBME1EQWdOREF3SWlCM2FXUjBhRDBpTkRBd0lpQm9aV2xuYUhROUlqUXdNQ0krUEdOcGNtTnNaU0JqZUQwaU1qQXdJaUJqZVQwaU1qQXdJaUJ5UFNJeE9EQWlJR1pwYkd3OUlpTkdSa1ZDTTBJaUlITjBjbTlyWlQwaUkwWkNRekF5UkNJZ2MzUnliMnRsTFhkcFpIUm9QU0l4TUNJdlBqeGxiR3hwY0hObElHTjRQU0l4TkRBaUlHTjVQU0l4TmpBaUlISjRQU0l6TUNJZ2NuazlJakl3SWlCbWFXeHNQU0lqWm1abUlpQnpkSEp2YTJVOUlpTXpNek1pSUhOMGNtOXJaUzEzYVdSMGFEMGlNeUl2UGp4amFYSmpiR1VnWTNnOUlqRTBNQ0lnWTNrOUlqRTJNQ0lnY2owaU1UQWlJR1pwYkd3OUlpTXpNek1pTHo0OFpXeHNhWEJ6WlNCamVEMGlNall3SWlCamVUMGlNVFl3SWlCeWVEMGlNekFpSUhKNVBTSXlNQ0lnWm1sc2JEMGlJMlptWmlJZ2MzUnliMnRsUFNJak16TXpJaUJ6ZEhKdmEyVXRkMmxrZEdnOUlqTWlMejQ4WTJseVkyeGxJR040UFNJeU5qQWlJR041UFNJeE5qQWlJSEk5SWpFd0lpQm1hV3hzUFNJak16TXpJaTgrUEhCaGRHZ2daRDBpVFRFd01DQXhNekJSTVRRd0lERXhNQ0F4T0RBZ01UTXdJaUJ6ZEhKdmEyVTlJaU16TXpNaUlITjBjbTlyWlMxM2FXUjBhRDBpTlNJZ1ptbHNiRDBpZEhKaGJuTndZWEpsYm5RaUx6NDhjR0YwYUNCa1BTSk5Nakl3SURFek1GRXlOakFnTVRFd0lETXdNQ0F4TXpBaUlITjBjbTlyWlQwaUl6TXpNeUlnYzNSeWIydGxMWGRwWkhSb1BTSTFJaUJtYVd4c1BTSjBjbUZ1YzNCaGNtVnVkQ0l2UGp4d1lYUm9JR1E5SWsweE16QWdNamd3VVRJd01DQXlNakFnTWpjd0lESTRNQ0lnYzNSeWIydGxQU0lqTXpNeklpQnpkSEp2YTJVdGQybGtkR2c5SWpnaUlHWnBiR3c5SW5SeVlXNXpjR0Z5Wlc1MElpOCtQSEJoZEdnZ1pEMGlUVEV6TUNBeE9EQkRNVEkxSURJeU1DQXhORFVnTWpRd0lERTFNQ0F5TWpBaUlHWnBiR3c5SW1Kc2RXVWlJR1pwYkd3dGIzQmhZMmwwZVQwaUxqWWlMejQ4Y0dGMGFDQmtQU0pOTWpjd0lERTRNRU15TmpVZ01qSXdJREk0TlNBeU5EQWdNamt3SURJeU1DSWdabWxzYkQwaVlteDFaU0lnWm1sc2JDMXZjR0ZqYVhSNVBTSXVOaUl2UGp4a1pXWnpQanh5WVdScFlXeEhjbUZrYVdWdWRDQnBaRDBpWTJobFpXdEhjbUZrYVdWdWRDSWdZM2c5SWpVd0pTSWdZM2s5SWpVd0pTSWdjajBpTlRBbElqNDhjM1J2Y0NCdlptWnpaWFE5SWpBbElpQnpkSGxzWlQwaWMzUnZjQzFqYjJ4dmNqcHlaMkpoS0RJMU5Td3hOVE1zTVRBeUxDNDBLVHR6ZEc5d0xXOXdZV05wZEhrNkxqUWlMejQ4YzNSdmNDQnZabVp6WlhROUlqRXdNQ1VpSUhOMGVXeGxQU0p6ZEc5d0xXTnZiRzl5T25KblltRW9NalUxTERFMU15d3hNRElzTUNrN2MzUnZjQzF2Y0dGamFYUjVPakFpTHo0OEwzSmhaR2xoYkVkeVlXUnBaVzUwUGp3dlpHVm1jejQ4Wld4c2FYQnpaU0JqZUQwaU1UUXdJaUJqZVQwaU1qVXdJaUJ5ZUQwaU5UQWlJSEo1UFNJek1DSWdabWxzYkQwaWRYSnNLQ05qYUdWbGEwZHlZV1JwWlc1MEtTSXZQanhsYkd4cGNITmxJR040UFNJeU5qQWlJR041UFNJeU5UQWlJSEo0UFNJMU1DSWdjbms5SWpNd0lpQm1hV3hzUFNKMWNtd29JMk5vWldWclIzSmhaR2xsYm5RcElpOCtQQzl6ZG1jKyJ9";
    DeployMoodNFT deployer;
    address USER = makeAddr("user");

    function setUp() public {
        deployer = new DeployMoodNFT();
        moodNft = deployer.run();
    }

    function testViewTokenURIIntegration() public {
        // Sets msg.sender to the specified address for the next call. “The next call” includes static calls as well, but not calls to the cheat code address.
        vm.prank(USER);
        moodNft.mintNft();
        console.log(moodNft.tokenURI(0));
    }

    function testFlipTokenToSad() public {
        vm.prank(USER);
        moodNft.mintNft();

        vm.prank(USER);
        moodNft.flipMood(0);

        assertEq(keccak256(abi.encodePacked(moodNft.tokenURI(0))), keccak256(abi.encodePacked(SAD_SVG_URI)));
    }
}
